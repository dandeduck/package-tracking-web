{%extends 'base.html' %}

{% block main_block %}
    <h2> All orders </h2>
    {% include "packages/parts/search.html" %}
    <ul>
        {% for order, amount, status, driver in order_amount_status_drivers %}
        <li>
            {{order.collection_date.date}} {{amount}} packages : <a href="/orders/{{order.id}}/"> tracking </a> :: {{status}}
            {%if is_staff %}
                <form name="drivers" method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="order" value="{{order.id}}"/>
                    <select name="driver" onchange="this.form.submit()">
                        {%for inner_driver in drivers%}
                            {%if inner_driver == driver %}
                                <option>{{driver}}</option>
                            {%endif%}
                        {%endfor%}
                        {%for other_driver in drivers%}
                            {%if other_driver != driver %}
                                <option>{{other_driver}}</option>
                            {%endif%}
                        {%endfor%}
                    </select>
                </form>
            {%endif%}
            <a href="/partners/{{partner.name}}/{{order.id}}/"> edit </a>
        </li>
        {% endfor %}
    </ul>
    <form name="new-order" action="/partners/{{partner}}/" method="POST"> {% csrf_token %}
        <a href="javascript:submitform('new-order')">+ new order</a>
    </form>
    <script type="text/javascript">
        function submitform(count) {
            document.forms[count].submit();
        }
    </script>
{% endblock %}